{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NodeWebSocketTransport = void 0;\n\nconst ws_1 = __importDefault(require(\"ws\"));\n\nclass NodeWebSocketTransport {\n  constructor(ws) {\n    this._ws = ws;\n\n    this._ws.addEventListener('message', event => {\n      if (this.onmessage) this.onmessage.call(null, event.data);\n    });\n\n    this._ws.addEventListener('close', () => {\n      if (this.onclose) this.onclose.call(null);\n    }); // Silently ignore all errors - we don't know what to do with them.\n\n\n    this._ws.addEventListener('error', () => {});\n\n    this.onmessage = null;\n    this.onclose = null;\n  }\n\n  static create(url) {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const pkg = require('../../../../package.json');\n\n    return new Promise((resolve, reject) => {\n      const ws = new ws_1.default(url, [], {\n        followRedirects: true,\n        perMessageDeflate: false,\n        maxPayload: 256 * 1024 * 1024,\n        headers: {\n          'User-Agent': `Puppeteer ${pkg.version}`\n        }\n      });\n      ws.addEventListener('open', () => resolve(new NodeWebSocketTransport(ws)));\n      ws.addEventListener('error', reject);\n    });\n  }\n\n  send(message) {\n    this._ws.send(message);\n  }\n\n  close() {\n    this._ws.close();\n  }\n\n}\n\nexports.NodeWebSocketTransport = NodeWebSocketTransport;","map":{"version":3,"mappings":";;;;;;;;;;;;;AAgBA;;AAEA,MAAaA,sBAAb,CAAmC;AAyBjCC,cAAYC,EAAZ,EAA6B;AAC3B,SAAKC,GAAL,GAAWD,EAAX;;AACA,SAAKC,GAAL,CAASC,gBAAT,CAA0B,SAA1B,EAAsCC,KAAD,IAAU;AAC7C,UAAI,KAAKC,SAAT,EAAoB,KAAKA,SAAL,CAAeC,IAAf,CAAoB,IAApB,EAA0BF,KAAK,CAACG,IAAhC;AACrB,KAFD;;AAGA,SAAKL,GAAL,CAASC,gBAAT,CAA0B,OAA1B,EAAmC,MAAK;AACtC,UAAI,KAAKK,OAAT,EAAkB,KAAKA,OAAL,CAAaF,IAAb,CAAkB,IAAlB;AACnB,KAFD,EAL2B,CAQ3B;;;AACA,SAAKJ,GAAL,CAASC,gBAAT,CAA0B,OAA1B,EAAmC,MAAK,CAAG,CAA3C;;AACA,SAAKE,SAAL,GAAiB,IAAjB;AACA,SAAKG,OAAL,GAAe,IAAf;AACD;;AApCY,SAANC,MAAM,CAACC,GAAD,EAAY;AACvB;AACA,UAAMC,GAAG,GAAGC,OAAO,CAAC,0BAAD,CAAnB;;AACA,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAoB;AACrC,YAAMd,EAAE,GAAG,IAAIe,YAAJ,CAAkBN,GAAlB,EAAuB,EAAvB,EAA2B;AACpCO,uBAAe,EAAE,IADmB;AAEpCC,yBAAiB,EAAE,KAFiB;AAGpCC,kBAAU,EAAE,MAAM,IAAN,GAAa,IAHW;AAIpCC,eAAO,EAAE;AACP,wBAAc,aAAaT,GAAG,CAACU,OAAO;AAD/B;AAJ2B,OAA3B,CAAX;AASApB,QAAE,CAACE,gBAAH,CAAoB,MAApB,EAA4B,MAC1BW,OAAO,CAAC,IAAIf,sBAAJ,CAA2BE,EAA3B,CAAD,CADT;AAGAA,QAAE,CAACE,gBAAH,CAAoB,OAApB,EAA6BY,MAA7B;AACD,KAdM,CAAP;AAeD;;AAoBDO,MAAI,CAACC,OAAD,EAAgB;AAClB,SAAKrB,GAAL,CAASoB,IAAT,CAAcC,OAAd;AACD;;AAEDC,OAAK;AACH,SAAKtB,GAAL,CAASsB,KAAT;AACD;;AA7CgC;;AAAnCC","names":["NodeWebSocketTransport","constructor","ws","_ws","addEventListener","event","onmessage","call","data","onclose","create","url","pkg","require","Promise","resolve","reject","ws_1","followRedirects","perMessageDeflate","maxPayload","headers","version","send","message","close","exports"],"sources":["../../../../src/node/NodeWebSocketTransport.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}