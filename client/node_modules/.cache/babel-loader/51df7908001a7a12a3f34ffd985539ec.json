{"ast":null,"code":"\"use strict\";\n/**\n * Copyright 2020 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.initializePuppeteerNode = void 0;\n\nconst Puppeteer_js_1 = require(\"./node/Puppeteer.js\");\n\nconst revisions_js_1 = require(\"./revisions.js\");\n\nconst pkg_dir_1 = require(\"pkg-dir\");\n\nconst path_1 = require(\"path\");\n\nfunction resolvePuppeteerRootDirectory() {\n  try {\n    // In some environments, like esbuild, this will throw an error.\n    // We suppress the error since the bundled binary is not expected\n    // to be used or installed in this case and, therefore, the\n    // root directory does not have to be known.\n    return (0, pkg_dir_1.sync)((0, path_1.dirname)(require.resolve('./initialize-node')));\n  } catch (error) {\n    // Fallback to __dirname.\n    return (0, pkg_dir_1.sync)(__dirname);\n  }\n}\n\nconst initializePuppeteerNode = packageName => {\n  const puppeteerRootDirectory = resolvePuppeteerRootDirectory();\n  let preferredRevision = revisions_js_1.PUPPETEER_REVISIONS.chromium;\n  const isPuppeteerCore = packageName === 'puppeteer-core'; // puppeteer-core ignores environment variables\n\n  const productName = isPuppeteerCore ? undefined : process.env.PUPPETEER_PRODUCT || process.env.npm_config_puppeteer_product || process.env.npm_package_config_puppeteer_product;\n  if (!isPuppeteerCore && productName === 'firefox') preferredRevision = revisions_js_1.PUPPETEER_REVISIONS.firefox;\n  return new Puppeteer_js_1.PuppeteerNode({\n    projectRoot: puppeteerRootDirectory,\n    preferredRevision,\n    isPuppeteerCore,\n    productName: productName\n  });\n};\n\nexports.initializePuppeteerNode = initializePuppeteerNode;","map":{"version":3,"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;AAgBA;;AACA;;AACA;;AACA;;AAGA,SAASA,6BAAT,GAAsC;AACpC,MAAI;AACF;AACA;AACA;AACA;AACA,WAAO,oBAAK,oBAAQC,OAAO,CAACC,OAAR,CAAgB,mBAAhB,CAAR,CAAL,CAAP;AACD,GAND,CAME,OAAOC,KAAP,EAAc;AACd;AACA,WAAO,oBAAKC,SAAL,CAAP;AACD;AACF;;AAEM,MAAMC,uBAAuB,GAAIC,WAAD,IAAuC;AAC5E,QAAMC,sBAAsB,GAAGP,6BAA6B,EAA5D;AACA,MAAIQ,iBAAiB,GAAGC,mCAAoBC,QAA5C;AACA,QAAMC,eAAe,GAAGL,WAAW,KAAK,gBAAxC,CAH4E,CAI5E;;AACA,QAAMM,WAAW,GAAGD,eAAe,GAC/BE,SAD+B,GAE/BC,OAAO,CAACC,GAAR,CAAYC,iBAAZ,IACAF,OAAO,CAACC,GAAR,CAAYE,4BADZ,IAEAH,OAAO,CAACC,GAAR,CAAYG,oCAJhB;AAMA,MAAI,CAACP,eAAD,IAAoBC,WAAW,KAAK,SAAxC,EACEJ,iBAAiB,GAAGC,mCAAoBU,OAAxC;AAEF,SAAO,IAAIC,4BAAJ,CAAkB;AACvBC,eAAW,EAAEd,sBADU;AAEvBC,qBAFuB;AAGvBG,mBAHuB;AAIvBC,eAAW,EAAEA;AAJU,GAAlB,CAAP;AAMD,CApBM;;AAAMU,kCAAuBjB,uBAAvB","names":["resolvePuppeteerRootDirectory","require","resolve","error","__dirname","initializePuppeteerNode","packageName","puppeteerRootDirectory","preferredRevision","revisions_js_1","chromium","isPuppeteerCore","productName","undefined","process","env","PUPPETEER_PRODUCT","npm_config_puppeteer_product","npm_package_config_puppeteer_product","firefox","Puppeteer_js_1","projectRoot","exports"],"sources":["../../../src/initialize-node.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}