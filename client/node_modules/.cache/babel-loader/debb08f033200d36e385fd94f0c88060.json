{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst os = __importStar(require(\"os\"));\n\nconst path = __importStar(require(\"path\"));\n\nconst fs = __importStar(require(\"fs\"));\n\nconst assert_js_1 = require(\"../common/assert.js\");\n\nconst BrowserFetcher_js_1 = require(\"./BrowserFetcher.js\");\n\nconst Browser_js_1 = require(\"../common/Browser.js\");\n\nconst BrowserRunner_js_1 = require(\"./BrowserRunner.js\");\n\nconst util_1 = require(\"util\");\n\nconst copyFileAsync = (0, util_1.promisify)(fs.copyFile);\nconst mkdtempAsync = (0, util_1.promisify)(fs.mkdtemp);\nconst writeFileAsync = (0, util_1.promisify)(fs.writeFile);\n\nconst tmpDir = () => process.env.PUPPETEER_TMP_DIR || os.tmpdir();\n/**\n * @internal\n */\n\n\nclass ChromeLauncher {\n  constructor(projectRoot, preferredRevision, isPuppeteerCore) {\n    this._projectRoot = projectRoot;\n    this._preferredRevision = preferredRevision;\n    this._isPuppeteerCore = isPuppeteerCore;\n  }\n\n  async launch() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    var _a;\n\n    const {\n      ignoreDefaultArgs = false,\n      args = [],\n      dumpio = false,\n      channel = null,\n      executablePath = null,\n      pipe = false,\n      env = process.env,\n      handleSIGINT = true,\n      handleSIGTERM = true,\n      handleSIGHUP = true,\n      ignoreHTTPSErrors = false,\n      defaultViewport = {\n        width: 800,\n        height: 600\n      },\n      slowMo = 0,\n      timeout = 30000,\n      waitForInitialPage = true,\n      debuggingPort = null\n    } = options;\n    const chromeArguments = [];\n    if (!ignoreDefaultArgs) chromeArguments.push(...this.defaultArgs(options));else if (Array.isArray(ignoreDefaultArgs)) chromeArguments.push(...this.defaultArgs(options).filter(arg => !ignoreDefaultArgs.includes(arg)));else chromeArguments.push(...args);\n\n    if (!chromeArguments.some(argument => argument.startsWith('--remote-debugging-'))) {\n      if (pipe) {\n        (0, assert_js_1.assert)(debuggingPort === null, 'Browser should be launched with either pipe or debugging port - not both.');\n        chromeArguments.push('--remote-debugging-pipe');\n      } else {\n        chromeArguments.push(`--remote-debugging-port=${debuggingPort || 0}`);\n      }\n    }\n\n    let userDataDir;\n    let isTempUserDataDir = true; // Check for the user data dir argument, which will always be set even\n    // with a custom directory specified via the userDataDir option.\n\n    const userDataDirIndex = chromeArguments.findIndex(arg => {\n      return arg.startsWith('--user-data-dir');\n    });\n\n    if (userDataDirIndex !== -1) {\n      userDataDir = chromeArguments[userDataDirIndex].split('=')[1];\n      isTempUserDataDir = false;\n    } else {\n      userDataDir = await mkdtempAsync(path.join(tmpDir(), 'puppeteer_dev_chrome_profile-'));\n      chromeArguments.push(`--user-data-dir=${userDataDir}`);\n    }\n\n    let chromeExecutable = executablePath;\n\n    if (channel) {\n      // executablePath is detected by channel, so it should not be specified by user.\n      (0, assert_js_1.assert)(!executablePath, '`executablePath` must not be specified when `channel` is given.');\n      chromeExecutable = executablePathForChannel(channel);\n    } else if (!executablePath) {\n      const {\n        missingText,\n        executablePath\n      } = resolveExecutablePath(this);\n      if (missingText) throw new Error(missingText);\n      chromeExecutable = executablePath;\n    }\n\n    if (!chromeExecutable) {\n      throw new Error('chromeExecutable is not found.');\n    }\n\n    const usePipe = chromeArguments.includes('--remote-debugging-pipe');\n    const runner = new BrowserRunner_js_1.BrowserRunner(this.product, chromeExecutable, chromeArguments, userDataDir, isTempUserDataDir);\n    runner.start({\n      handleSIGHUP,\n      handleSIGTERM,\n      handleSIGINT,\n      dumpio,\n      env,\n      pipe: usePipe\n    });\n    let browser;\n\n    try {\n      const connection = await runner.setupConnection({\n        usePipe,\n        timeout,\n        slowMo,\n        preferredRevision: this._preferredRevision\n      });\n      browser = await Browser_js_1.Browser.create(connection, [], ignoreHTTPSErrors, defaultViewport, (_a = runner.proc) !== null && _a !== void 0 ? _a : undefined, runner.close.bind(runner));\n    } catch (error) {\n      runner.kill();\n      throw error;\n    }\n\n    if (waitForInitialPage) {\n      try {\n        await browser.waitForTarget(t => t.type() === 'page', {\n          timeout\n        });\n      } catch (error) {\n        await browser.close();\n        throw error;\n      }\n    }\n\n    return browser;\n  }\n\n  defaultArgs() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const chromeArguments = ['--disable-background-networking', '--enable-features=NetworkService,NetworkServiceInProcess', '--disable-background-timer-throttling', '--disable-backgrounding-occluded-windows', '--disable-breakpad', '--disable-client-side-phishing-detection', '--disable-component-extensions-with-background-pages', '--disable-default-apps', '--disable-dev-shm-usage', '--disable-extensions', '--disable-features=Translate', '--disable-hang-monitor', '--disable-ipc-flooding-protection', '--disable-popup-blocking', '--disable-prompt-on-repost', '--disable-renderer-backgrounding', '--disable-sync', '--force-color-profile=srgb', '--metrics-recording-only', '--no-first-run', '--enable-automation', '--password-store=basic', '--use-mock-keychain', // TODO(sadym): remove '--enable-blink-features=IdleDetection'\n    // once IdleDetection is turned on by default.\n    '--enable-blink-features=IdleDetection', '--export-tagged-pdf'];\n    const {\n      devtools = false,\n      headless = !devtools,\n      args = [],\n      userDataDir = null\n    } = options;\n    if (userDataDir) chromeArguments.push(`--user-data-dir=${path.resolve(userDataDir)}`);\n    if (devtools) chromeArguments.push('--auto-open-devtools-for-tabs');\n\n    if (headless) {\n      chromeArguments.push('--headless', '--hide-scrollbars', '--mute-audio');\n    }\n\n    if (args.every(arg => arg.startsWith('-'))) chromeArguments.push('about:blank');\n    chromeArguments.push(...args);\n    return chromeArguments;\n  }\n\n  executablePath(channel) {\n    if (channel) {\n      return executablePathForChannel(channel);\n    } else {\n      return resolveExecutablePath(this).executablePath;\n    }\n  }\n\n  get product() {\n    return 'chrome';\n  }\n\n}\n/**\n * @internal\n */\n\n\nclass FirefoxLauncher {\n  constructor(projectRoot, preferredRevision, isPuppeteerCore) {\n    this._projectRoot = projectRoot;\n    this._preferredRevision = preferredRevision;\n    this._isPuppeteerCore = isPuppeteerCore;\n  }\n\n  async launch() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      ignoreDefaultArgs = false,\n      args = [],\n      dumpio = false,\n      executablePath = null,\n      pipe = false,\n      env = process.env,\n      handleSIGINT = true,\n      handleSIGTERM = true,\n      handleSIGHUP = true,\n      ignoreHTTPSErrors = false,\n      defaultViewport = {\n        width: 800,\n        height: 600\n      },\n      slowMo = 0,\n      timeout = 30000,\n      extraPrefsFirefox = {},\n      waitForInitialPage = true,\n      debuggingPort = null\n    } = options;\n    const firefoxArguments = [];\n    if (!ignoreDefaultArgs) firefoxArguments.push(...this.defaultArgs(options));else if (Array.isArray(ignoreDefaultArgs)) firefoxArguments.push(...this.defaultArgs(options).filter(arg => !ignoreDefaultArgs.includes(arg)));else firefoxArguments.push(...args);\n\n    if (!firefoxArguments.some(argument => argument.startsWith('--remote-debugging-'))) {\n      if (pipe) {\n        (0, assert_js_1.assert)(debuggingPort === null, 'Browser should be launched with either pipe or debugging port - not both.');\n      }\n\n      firefoxArguments.push(`--remote-debugging-port=${debuggingPort || 0}`);\n    }\n\n    let userDataDir = null;\n    let isTempUserDataDir = true; // Check for the profile argument, which will always be set even\n    // with a custom directory specified via the userDataDir option.\n\n    const profileArgIndex = firefoxArguments.findIndex(arg => {\n      return ['-profile', '--profile'].includes(arg);\n    });\n\n    if (profileArgIndex !== -1) {\n      userDataDir = firefoxArguments[profileArgIndex + 1];\n\n      if (!fs.existsSync(userDataDir)) {\n        throw new Error(`Firefox profile not found at '${userDataDir}'`);\n      } // When using a custom Firefox profile it needs to be populated\n      // with required preferences.\n\n\n      isTempUserDataDir = false;\n      const prefs = this.defaultPreferences(extraPrefsFirefox);\n      this.writePreferences(prefs, userDataDir);\n    } else {\n      userDataDir = await this._createProfile(extraPrefsFirefox);\n      firefoxArguments.push('--profile');\n      firefoxArguments.push(userDataDir);\n    }\n\n    await this._updateRevision();\n    let firefoxExecutable = executablePath;\n\n    if (!executablePath) {\n      const {\n        missingText,\n        executablePath\n      } = resolveExecutablePath(this);\n      if (missingText) throw new Error(missingText);\n      firefoxExecutable = executablePath;\n    }\n\n    if (!firefoxExecutable) {\n      throw new Error('firefoxExecutable is not found.');\n    }\n\n    const runner = new BrowserRunner_js_1.BrowserRunner(this.product, firefoxExecutable, firefoxArguments, userDataDir, isTempUserDataDir);\n    runner.start({\n      handleSIGHUP,\n      handleSIGTERM,\n      handleSIGINT,\n      dumpio,\n      env,\n      pipe\n    });\n    let browser;\n\n    try {\n      const connection = await runner.setupConnection({\n        usePipe: pipe,\n        timeout,\n        slowMo,\n        preferredRevision: this._preferredRevision\n      });\n      browser = await Browser_js_1.Browser.create(connection, [], ignoreHTTPSErrors, defaultViewport, runner.proc, runner.close.bind(runner));\n    } catch (error) {\n      runner.kill();\n      throw error;\n    }\n\n    if (waitForInitialPage) {\n      try {\n        await browser.waitForTarget(t => t.type() === 'page', {\n          timeout\n        });\n      } catch (error) {\n        await browser.close();\n        throw error;\n      }\n    }\n\n    return browser;\n  }\n\n  executablePath() {\n    return resolveExecutablePath(this).executablePath;\n  }\n\n  async _updateRevision() {\n    // replace 'latest' placeholder with actual downloaded revision\n    if (this._preferredRevision === 'latest') {\n      if (!this._projectRoot) {\n        throw new Error('_projectRoot is undefined. Unable to create a BrowserFetcher.');\n      }\n\n      const browserFetcher = new BrowserFetcher_js_1.BrowserFetcher(this._projectRoot, {\n        product: this.product\n      });\n      const localRevisions = await browserFetcher.localRevisions();\n      if (localRevisions[0]) this._preferredRevision = localRevisions[0];\n    }\n  }\n\n  get product() {\n    return 'firefox';\n  }\n\n  defaultArgs() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      devtools = false,\n      headless = !devtools,\n      args = [],\n      userDataDir = null\n    } = options;\n    const firefoxArguments = ['--no-remote'];\n    if (os.platform() === 'darwin') firefoxArguments.push('--foreground');else if (os.platform().startsWith('win')) {\n      firefoxArguments.push('--wait-for-browser');\n    }\n\n    if (userDataDir) {\n      firefoxArguments.push('--profile');\n      firefoxArguments.push(userDataDir);\n    }\n\n    if (headless) firefoxArguments.push('--headless');\n    if (devtools) firefoxArguments.push('--devtools');\n    if (args.every(arg => arg.startsWith('-'))) firefoxArguments.push('about:blank');\n    firefoxArguments.push(...args);\n    return firefoxArguments;\n  }\n\n  defaultPreferences(extraPrefs) {\n    const server = 'dummy.test';\n    const defaultPrefs = {\n      // Make sure Shield doesn't hit the network.\n      'app.normandy.api_url': '',\n      // Disable Firefox old build background check\n      'app.update.checkInstallTime': false,\n      // Disable automatically upgrading Firefox\n      'app.update.disabledForTesting': true,\n      // Increase the APZ content response timeout to 1 minute\n      'apz.content_response_timeout': 60000,\n      // Prevent various error message on the console\n      // jest-puppeteer asserts that no error message is emitted by the console\n      'browser.contentblocking.features.standard': '-tp,tpPrivate,cookieBehavior0,-cm,-fp',\n      // Enable the dump function: which sends messages to the system\n      // console\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=1543115\n      'browser.dom.window.dump.enabled': true,\n      // Disable topstories\n      'browser.newtabpage.activity-stream.feeds.system.topstories': false,\n      // Always display a blank page\n      'browser.newtabpage.enabled': false,\n      // Background thumbnails in particular cause grief: and disabling\n      // thumbnails in general cannot hurt\n      'browser.pagethumbnails.capturing_disabled': true,\n      // Disable safebrowsing components.\n      'browser.safebrowsing.blockedURIs.enabled': false,\n      'browser.safebrowsing.downloads.enabled': false,\n      'browser.safebrowsing.malware.enabled': false,\n      'browser.safebrowsing.passwords.enabled': false,\n      'browser.safebrowsing.phishing.enabled': false,\n      // Disable updates to search engines.\n      'browser.search.update': false,\n      // Do not restore the last open set of tabs if the browser has crashed\n      'browser.sessionstore.resume_from_crash': false,\n      // Skip check for default browser on startup\n      'browser.shell.checkDefaultBrowser': false,\n      // Disable newtabpage\n      'browser.startup.homepage': 'about:blank',\n      // Do not redirect user when a milstone upgrade of Firefox is detected\n      'browser.startup.homepage_override.mstone': 'ignore',\n      // Start with a blank page about:blank\n      'browser.startup.page': 0,\n      // Do not allow background tabs to be zombified on Android: otherwise for\n      // tests that open additional tabs: the test harness tab itself might get\n      // unloaded\n      'browser.tabs.disableBackgroundZombification': false,\n      // Do not warn when closing all other open tabs\n      'browser.tabs.warnOnCloseOtherTabs': false,\n      // Do not warn when multiple tabs will be opened\n      'browser.tabs.warnOnOpen': false,\n      // Disable the UI tour.\n      'browser.uitour.enabled': false,\n      // Turn off search suggestions in the location bar so as not to trigger\n      // network connections.\n      'browser.urlbar.suggest.searches': false,\n      // Disable first run splash page on Windows 10\n      'browser.usedOnWindows10.introURL': '',\n      // Do not warn on quitting Firefox\n      'browser.warnOnQuit': false,\n      // Defensively disable data reporting systems\n      'datareporting.healthreport.documentServerURI': `http://${server}/dummy/healthreport/`,\n      'datareporting.healthreport.logging.consoleEnabled': false,\n      'datareporting.healthreport.service.enabled': false,\n      'datareporting.healthreport.service.firstRun': false,\n      'datareporting.healthreport.uploadEnabled': false,\n      // Do not show datareporting policy notifications which can interfere with tests\n      'datareporting.policy.dataSubmissionEnabled': false,\n      'datareporting.policy.dataSubmissionPolicyBypassNotification': true,\n      // DevTools JSONViewer sometimes fails to load dependencies with its require.js.\n      // This doesn't affect Puppeteer but spams console (Bug 1424372)\n      'devtools.jsonview.enabled': false,\n      // Disable popup-blocker\n      'dom.disable_open_during_load': false,\n      // Enable the support for File object creation in the content process\n      // Required for |Page.setFileInputFiles| protocol method.\n      'dom.file.createInChild': true,\n      // Disable the ProcessHangMonitor\n      'dom.ipc.reportProcessHangs': false,\n      // Disable slow script dialogues\n      'dom.max_chrome_script_run_time': 0,\n      'dom.max_script_run_time': 0,\n      // Only load extensions from the application and user profile\n      // AddonManager.SCOPE_PROFILE + AddonManager.SCOPE_APPLICATION\n      'extensions.autoDisableScopes': 0,\n      'extensions.enabledScopes': 5,\n      // Disable metadata caching for installed add-ons by default\n      'extensions.getAddons.cache.enabled': false,\n      // Disable installing any distribution extensions or add-ons.\n      'extensions.installDistroAddons': false,\n      // Disabled screenshots extension\n      'extensions.screenshots.disabled': true,\n      // Turn off extension updates so they do not bother tests\n      'extensions.update.enabled': false,\n      // Turn off extension updates so they do not bother tests\n      'extensions.update.notifyUser': false,\n      // Make sure opening about:addons will not hit the network\n      'extensions.webservice.discoverURL': `http://${server}/dummy/discoveryURL`,\n      // Temporarily force disable BFCache in parent (https://bit.ly/bug-1732263)\n      'fission.bfcacheInParent': false,\n      // Force all web content to use a single content process\n      'fission.webContentIsolationStrategy': 0,\n      // Allow the application to have focus even it runs in the background\n      'focusmanager.testmode': true,\n      // Disable useragent updates\n      'general.useragent.updates.enabled': false,\n      // Always use network provider for geolocation tests so we bypass the\n      // macOS dialog raised by the corelocation provider\n      'geo.provider.testing': true,\n      // Do not scan Wifi\n      'geo.wifi.scan': false,\n      // No hang monitor\n      'hangmonitor.timeout': 0,\n      // Show chrome errors and warnings in the error console\n      'javascript.options.showInConsole': true,\n      // Disable download and usage of OpenH264: and Widevine plugins\n      'media.gmp-manager.updateEnabled': false,\n      // Prevent various error message on the console\n      // jest-puppeteer asserts that no error message is emitted by the console\n      'network.cookie.cookieBehavior': 0,\n      // Disable experimental feature that is only available in Nightly\n      'network.cookie.sameSite.laxByDefault': false,\n      // Do not prompt for temporary redirects\n      'network.http.prompt-temp-redirect': false,\n      // Disable speculative connections so they are not reported as leaking\n      // when they are hanging around\n      'network.http.speculative-parallel-limit': 0,\n      // Do not automatically switch between offline and online\n      'network.manage-offline-status': false,\n      // Make sure SNTP requests do not hit the network\n      'network.sntp.pools': server,\n      // Disable Flash.\n      'plugin.state.flash': 0,\n      'privacy.trackingprotection.enabled': false,\n      // Can be removed once Firefox 89 is no longer supported\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=1710839\n      'remote.enabled': true,\n      // Don't do network connections for mitm priming\n      'security.certerrors.mitm.priming.enabled': false,\n      // Local documents have access to all other local documents,\n      // including directory listings\n      'security.fileuri.strict_origin_policy': false,\n      // Do not wait for the notification button security delay\n      'security.notification_enable_delay': 0,\n      // Ensure blocklist updates do not hit the network\n      'services.settings.server': `http://${server}/dummy/blocklist/`,\n      // Do not automatically fill sign-in forms with known usernames and\n      // passwords\n      'signon.autofillForms': false,\n      // Disable password capture, so that tests that include forms are not\n      // influenced by the presence of the persistent doorhanger notification\n      'signon.rememberSignons': false,\n      // Disable first-run welcome page\n      'startup.homepage_welcome_url': 'about:blank',\n      // Disable first-run welcome page\n      'startup.homepage_welcome_url.additional': '',\n      // Disable browser animations (tabs, fullscreen, sliding alerts)\n      'toolkit.cosmeticAnimations.enabled': false,\n      // Prevent starting into safe mode after application crashes\n      'toolkit.startup.max_resumed_crashes': -1\n    };\n    return Object.assign(defaultPrefs, extraPrefs);\n  }\n  /**\n   * Populates the user.js file with custom preferences as needed to allow\n   * Firefox's CDP support to properly function. These preferences will be\n   * automatically copied over to prefs.js during startup of Firefox. To be\n   * able to restore the original values of preferences a backup of prefs.js\n   * will be created.\n   *\n   * @param prefs List of preferences to add.\n   * @param profilePath Firefox profile to write the preferences to.\n   */\n\n\n  async writePreferences(prefs, profilePath) {\n    const lines = Object.entries(prefs).map(_ref => {\n      let [key, value] = _ref;\n      return `user_pref(${JSON.stringify(key)}, ${JSON.stringify(value)});`;\n    });\n    await writeFileAsync(path.join(profilePath, 'user.js'), lines.join('\\n')); // Create a backup of the preferences file if it already exitsts.\n\n    const prefsPath = path.join(profilePath, 'prefs.js');\n\n    if (fs.existsSync(prefsPath)) {\n      const prefsBackupPath = path.join(profilePath, 'prefs.js.puppeteer');\n      await copyFileAsync(prefsPath, prefsBackupPath);\n    }\n  }\n\n  async _createProfile(extraPrefs) {\n    const temporaryProfilePath = await mkdtempAsync(path.join(tmpDir(), 'puppeteer_dev_firefox_profile-'));\n    const prefs = this.defaultPreferences(extraPrefs);\n    await this.writePreferences(prefs, temporaryProfilePath);\n    return temporaryProfilePath;\n  }\n\n}\n\nfunction executablePathForChannel(channel) {\n  const platform = os.platform();\n  let chromePath;\n\n  switch (platform) {\n    case 'win32':\n      switch (channel) {\n        case 'chrome':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`;\n          break;\n\n        case 'chrome-beta':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`;\n          break;\n\n        case 'chrome-canary':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`;\n          break;\n\n        case 'chrome-dev':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`;\n          break;\n      }\n\n      break;\n\n    case 'darwin':\n      switch (channel) {\n        case 'chrome':\n          chromePath = '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n          break;\n\n        case 'chrome-beta':\n          chromePath = '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta';\n          break;\n\n        case 'chrome-canary':\n          chromePath = '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary';\n          break;\n\n        case 'chrome-dev':\n          chromePath = '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev';\n          break;\n      }\n\n      break;\n\n    case 'linux':\n      switch (channel) {\n        case 'chrome':\n          chromePath = '/opt/google/chrome/chrome';\n          break;\n\n        case 'chrome-beta':\n          chromePath = '/opt/google/chrome-beta/chrome';\n          break;\n\n        case 'chrome-dev':\n          chromePath = '/opt/google/chrome-unstable/chrome';\n          break;\n      }\n\n      break;\n  }\n\n  if (!chromePath) {\n    throw new Error(`Unable to detect browser executable path for '${channel}' on ${platform}.`);\n  } // Check if Chrome exists and is accessible.\n\n\n  try {\n    fs.accessSync(chromePath);\n  } catch (error) {\n    throw new Error(`Could not find Google Chrome executable for channel '${channel}' at '${chromePath}'.`);\n  }\n\n  return chromePath;\n}\n\nfunction resolveExecutablePath(launcher) {\n  const {\n    product,\n    _isPuppeteerCore,\n    _projectRoot,\n    _preferredRevision\n  } = launcher;\n  let downloadPath; // puppeteer-core doesn't take into account PUPPETEER_* env variables.\n\n  if (!_isPuppeteerCore) {\n    const executablePath = process.env.PUPPETEER_EXECUTABLE_PATH || process.env.npm_config_puppeteer_executable_path || process.env.npm_package_config_puppeteer_executable_path;\n\n    if (executablePath) {\n      const missingText = !fs.existsSync(executablePath) ? 'Tried to use PUPPETEER_EXECUTABLE_PATH env variable to launch browser but did not find any executable at: ' + executablePath : undefined;\n      return {\n        executablePath,\n        missingText\n      };\n    }\n\n    const ubuntuChromiumPath = '/usr/bin/chromium-browser';\n\n    if (product === 'chrome' && os.platform() !== 'darwin' && os.arch() === 'arm64' && fs.existsSync(ubuntuChromiumPath)) {\n      return {\n        executablePath: ubuntuChromiumPath,\n        missingText: undefined\n      };\n    }\n\n    downloadPath = process.env.PUPPETEER_DOWNLOAD_PATH || process.env.npm_config_puppeteer_download_path || process.env.npm_package_config_puppeteer_download_path;\n  }\n\n  if (!_projectRoot) {\n    throw new Error('_projectRoot is undefined. Unable to create a BrowserFetcher.');\n  }\n\n  const browserFetcher = new BrowserFetcher_js_1.BrowserFetcher(_projectRoot, {\n    product: product,\n    path: downloadPath\n  });\n\n  if (!_isPuppeteerCore && product === 'chrome') {\n    const revision = process.env['PUPPETEER_CHROMIUM_REVISION'];\n\n    if (revision) {\n      const revisionInfo = browserFetcher.revisionInfo(revision);\n      const missingText = !revisionInfo.local ? 'Tried to use PUPPETEER_CHROMIUM_REVISION env variable to launch browser but did not find executable at: ' + revisionInfo.executablePath : undefined;\n      return {\n        executablePath: revisionInfo.executablePath,\n        missingText\n      };\n    }\n  }\n\n  const revisionInfo = browserFetcher.revisionInfo(_preferredRevision);\n  const firefoxHelp = `Run \\`PUPPETEER_PRODUCT=firefox npm install\\` to download a supported Firefox browser binary.`;\n  const chromeHelp = `Run \\`npm install\\` to download the correct Chromium revision (${launcher._preferredRevision}).`;\n  const missingText = !revisionInfo.local ? `Could not find expected browser (${product}) locally. ${product === 'chrome' ? chromeHelp : firefoxHelp}` : undefined;\n  return {\n    executablePath: revisionInfo.executablePath,\n    missingText\n  };\n}\n/**\n * @internal\n */\n\n\nfunction Launcher(projectRoot, preferredRevision, isPuppeteerCore, product) {\n  // puppeteer-core doesn't take into account PUPPETEER_* env variables.\n  if (!product && !isPuppeteerCore) product = process.env.PUPPETEER_PRODUCT || process.env.npm_config_puppeteer_product || process.env.npm_package_config_puppeteer_product;\n\n  switch (product) {\n    case 'firefox':\n      return new FirefoxLauncher(projectRoot, preferredRevision, isPuppeteerCore);\n\n    case 'chrome':\n    default:\n      if (typeof product !== 'undefined' && product !== 'chrome') {\n        /* The user gave us an incorrect product name\n         * we'll default to launching Chrome, but log to the console\n         * to let the user know (they've probably typoed).\n         */\n        console.warn(`Warning: unknown product name ${product}. Falling back to chrome.`);\n      }\n\n      return new ChromeLauncher(projectRoot, preferredRevision, isPuppeteerCore);\n  }\n}\n\nexports.default = Launcher;","map":{"version":3,"mappings":"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","names":["copyFileAsync","fs","copyFile","mkdtempAsync","mkdtemp","writeFileAsync","writeFile","tmpDir","process","env","PUPPETEER_TMP_DIR","os","tmpdir","ChromeLauncher","constructor","projectRoot","preferredRevision","isPuppeteerCore","_projectRoot","_preferredRevision","_isPuppeteerCore","launch","options","ignoreDefaultArgs","args","dumpio","channel","executablePath","pipe","handleSIGINT","handleSIGTERM","handleSIGHUP","ignoreHTTPSErrors","defaultViewport","width","height","slowMo","timeout","waitForInitialPage","debuggingPort","chromeArguments","push","defaultArgs","Array","isArray","filter","arg","includes","some","argument","startsWith","userDataDir","isTempUserDataDir","userDataDirIndex","findIndex","split","path","join","chromeExecutable","executablePathForChannel","missingText","resolveExecutablePath","Error","usePipe","runner","BrowserRunner_js_1","product","start","browser","connection","setupConnection","Browser_js_1","create","proc","_a","undefined","close","bind","error","kill","waitForTarget","t","type","devtools","headless","resolve","every","FirefoxLauncher","extraPrefsFirefox","firefoxArguments","profileArgIndex","existsSync","prefs","defaultPreferences","writePreferences","_createProfile","_updateRevision","firefoxExecutable","browserFetcher","BrowserFetcher_js_1","localRevisions","platform","extraPrefs","server","defaultPrefs","Object","assign","profilePath","lines","entries","map","key","value","JSON","stringify","prefsPath","prefsBackupPath","temporaryProfilePath","chromePath","PROGRAMFILES","accessSync","launcher","downloadPath","PUPPETEER_EXECUTABLE_PATH","npm_config_puppeteer_executable_path","npm_package_config_puppeteer_executable_path","ubuntuChromiumPath","arch","PUPPETEER_DOWNLOAD_PATH","npm_config_puppeteer_download_path","npm_package_config_puppeteer_download_path","revision","revisionInfo","local","firefoxHelp","chromeHelp","Launcher","PUPPETEER_PRODUCT","npm_config_puppeteer_product","npm_package_config_puppeteer_product","console","warn","exports"],"sources":["../../../../src/node/Launcher.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}